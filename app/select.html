<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <div class="form-select">
        <input class="form-select__input" type="hidden" name="" value="0" readonly>
        <div class="form-select__output-wrap">
            <div class="form-select__output">...</div>
        </div>
        <ul class="form-select__options">
            <li class="form-select__option" data-value="10">
                <div style="color: red;">sdgfsdfgs</div>
            </li>
            <li class="form-select__option" data-value="20">test2</li>
        </ul>
    </div>

    <script>
        document.querySelectorAll('.form-select').forEach(element => {
            try {
                let isVisible = isSync = false;

                const input = element.querySelector('.form-select__input');
                const output = element.querySelector('.form-select__output');
                const outputWrap = element.querySelector('.form-select__output-wrap');
                const blockOptions = element.querySelector('.form-select__options');

                !input && console.error('not .form-select__input: ', element);
                !output && console.error('not .form-select__output: ', element);
                !outputWrap && console.error('not .form-select__output-wrap: ', element);
                !blockOptions && console.error('not .form-select__options: ', element);

                outputWrap.addEventListener('click', () => {
                    blockOptions.classList.toggle('is-visible');
                    isVisible = !isVisible;
                    isVisible && (isSync = true);
                });

                document.onclick = function (e) {
                    if (isVisible && !isSync && e.target.closest('.form-select__options') !== blockOptions) {
                        isVisible = false;
                        blockOptions.classList.remove('is-visible');
                    };
                    isSync = false;
                };

                function addEvent(element) {
                    element.classList.contains('form-select__option') && element.addEventListener('click', function (event) {
                        isVisible = false;
                        blockOptions.classList.remove('is-visible');
                        input.value = element.getAttribute('data-value');
                        output.innerHTML = element.innerHTML;
                        blockOptions.querySelectorAll('.form-select__option').forEach(element => element.classList.remove('is-selected'));
                        element.classList.add('is-selected');
                        input.dispatchEvent(new Event('change'));
                    });
                }

                blockOptions.querySelectorAll('.form-select__option').forEach(element => addEvent(element));

                (new MutationObserver(function (mutationsList, observer) {
                    for (let mutation of mutationsList) {
                        if (mutation.type === 'childList') {
                            mutation.addedNodes.forEach(element => addEvent(element));
                            // ??? - заменить на default
                            input.value = 0;
                            output.innerHTML = '...';
                        }
                    }
                })).observe(blockOptions, { childList: true });
            } catch (err) {
                console.log(err)
            }
        });
    </script>

    <style>
        .form-select {
            position: relative;
            cursor: pointer;
            user-select: none;
        }

        .form-select__output-wrap {
            border: 1px solid;
        }

        .form-select__output-wrap:has(+ .form-select-chosen__search.is-visible) {
            border-bottom: none;
        }

        .form-select__output {}

        .form-select__options {
            box-sizing: border-box;
            position: absolute;
            width: 100%;
            display: flex;
            flex-direction: column;
            padding: .25rem;
            border: 1px solid;
            border-top: none;
            background-color: white;
            gap: .25rem;
            margin: 0;
            padding: 0;
            list-style-type: none;
            max-height: 20rem;
            overflow: overlay;
        }

        .form-select__options:not(.is-visible) {
            display: none;
        }

        .form-select__option {}

        .form-select__option:hover {
            background-color: rgb(37, 85, 85);
            color: white;
        }

        .form-select__option.is-selected {
            background-color: rgb(21, 43, 43);
            color: white;
        }
    </style>
</body>

</html>